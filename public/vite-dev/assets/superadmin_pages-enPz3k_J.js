import{_ as u,n as p,o as c,p as t,t as r,m as w,H as C,i as y,x as _,e as k,a as h,g as I,F as T,j as D,L as j,k as M,f as S,c as $,u as B,h as P}from"./_plugin-vue_export-helper-n_vHXFlc.js";import{u as N,k as O}from"./vue-dompurify-html-CEAHYyWB.js";import{B as E}from"./BarChart-BLu1KVZQ.js";import"./_commonjsHelpers-BosuxZz1.js";const U={__name:"Header",props:{responseSourcePath:{type:String,required:!0},responseSourceName:{type:String,required:!0}},setup(o,{expose:e}){e();const s={};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}},H={class:"flex items-center px-8 py-4 bg-white border-b border-slate-100",role:"banner"},L=["href"],A={class:"flex flex-col h-14 justify-center"},V={class:"text-sm text-slate-600"},q={class:"font-medium"};function F(o,e,s,n,i,d){return c(),p("header",H,[t("a",{href:s.responseSourcePath,class:"text-woot-500 hover:underline mr-4"},r("Back"),8,L),e[3]||(e[3]=t("div",{class:"border border-solid border-slate-100 text-slate-700 mr-4 p-2 rounded-full"},[t("svg",{width:"24",height:"24"},[t("use",{"xlink:href":"#icon-mist-fill"})])],-1)),t("div",A,[e[2]||(e[2]=t("h1",{id:"page-title",class:"text-base font-medium text-slate-900"},r("Robin AI playground"),-1)),t("p",V,[e[0]||(e[0]=w(r("Chat with the source")+" ")),t("span",q,r(s.responseSourceName),1),e[1]||(e[1]=w(" "+r("and evaluate itâ€™s efficiency.")))])])])}const W=u(U,[["render",F],["__file","/app/app/javascript/superadmin_pages/components/playground/Header.vue"]]),R={__name:"UserMessage",props:{message:{type:String,required:!0}},setup(o,{expose:e}){e();const s={};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}},J={class:"w-full mb-4 flex items-center justify-end"},K={class:"px-4 py-3 bg-woot-400 text-white text-sm rounded-md inline-block"};function z(o,e,s,n,i,d){const l=C("dompurify-html");return c(),p("div",J,[y(t("div",K,null,512),[[l,s.message]])])}const X=u(R,[["render",z],["__file","/app/app/javascript/superadmin_pages/components/playground/UserMessage.vue"]]),Y={__name:"BotMessage",props:{message:{type:String,required:!0}},setup(o,{expose:e}){e();const s={};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}},G={class:"w-full mb-4 flex items-center justify-start"},Q={class:"px-4 py-3 bg-white max-w-4xl text-slate-700 leading-6 text-sm rounded-md inline-block border border-slate-100"};function Z(o,e,s,n,i,d){const l=C("dompurify-html");return c(),p("div",G,[y(t("div",Q,null,512),[[l,s.message]])])}const ee=u(Y,[["render",Z],["__file","/app/app/javascript/superadmin_pages/components/playground/BotMessage.vue"]]),se="/vite-dev/assets/typing-DYm07fFx.gif",te={__name:"TypingIndicator",setup(o,{expose:e}){e();const s={get TypingIndicator(){return se}};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}},oe={class:"w-full mb-4 flex items-center justify-start"},ne={class:"px-2 py-2 bg-white max-w-4xl text-slate-700 leading-6 text-sm rounded-md inline-block border border-slate-100"},re=["src"];function ae(o,e,s,n,i,d){return c(),p("div",oe,[t("div",ne,[t("img",{src:n.TypingIndicator,alt:"TypingIndicator",class:"h-4"},null,8,re)])])}const ie=u(te,[["render",ae],["__file","/app/app/javascript/superadmin_pages/components/playground/TypingIndicator.vue"]]),de={components:{PlaygroundHeader:W,UserMessage:X,BotMessage:ee,TypingIndicator:ie},props:{componentData:{type:Object,default:()=>({})}},setup(){const{formatMessage:o}=N();return{formatMessage:o}},data(){return{messages:[],messageContent:"",isWaiting:!1}},computed:{previousMessages(){return this.messages.map(o=>({type:o.type,message:o.content}))}},mounted(){this.focusInput()},methods:{focusInput(){this.$refs.messageInput.focus()},onMessageSend(){this.addMessageToData("User",this.messageContent),this.sendMessageToServer(this.messageContent)},scrollToLastMessage(){this.$nextTick(()=>{const o=this.messages[this.messages.length-1].id;document.getElementById(`message-${o}`).scrollIntoView({behavior:"smooth"})})},addMessageToData(o,e){this.messages.push({id:this.messages.length,type:o,content:e}),this.scrollToLastMessage()},async sendMessageToServer(o){this.messageContent="",this.isWaiting=!0;const e=document.querySelector('meta[name="csrf-token"]').getAttribute("content");try{const s=await fetch(window.location.href,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":e},body:JSON.stringify({message:o,previous_messages:this.previousMessages}),credentials:"include"});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const{message:n}=await s.json();this.addMessageToData("Bot",n)}catch{this.addMessageToData("bot","Error: Could not retrieve response. Please check the console for more details.")}finally{this.isWaiting=!1,this.focusInput()}}}},ce={class:"flex flex-col w-full h-full bg-slate-25"},pe={class:"flex-1 px-8 py-4 overflow-auto"},le=["id"],ue={class:"w-full px-8 py-6"};function me(o,e,s,n,i,d){const l=_("PlaygroundHeader"),g=_("UserMessage"),f=_("BotMessage"),m=_("TypingIndicator");return c(),p("section",ce,[k(l,{"response-source-name":s.componentData.responseSourceName,"response-source-path":s.componentData.responseSourcePath},null,8,["response-source-name","response-source-path"]),t("div",pe,[(c(!0),p(T,null,D(i.messages,a=>(c(),p("div",{id:`message-${a.id}`,key:a.id},[a.type==="User"?(c(),h(g,{key:0,message:n.formatMessage(a.content)},null,8,["message"])):(c(),h(f,{key:1,message:n.formatMessage(a.content)},null,8,["message"]))],8,le))),128)),i.isWaiting?(c(),h(m,{key:0})):I("v-if",!0)]),t("div",ue,[y(t("textarea",{ref:"messageInput","onUpdate:modelValue":e[0]||(e[0]=a=>i.messageContent=a),rows:4,class:"resize-none block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border !outline-2 border-slate-100 focus:ring-woot-500 focus:border-woot-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-woot-500 dark:focus:border-woot-500",placeholder:"Type a message... [CMD/CTRL + Enter to send]",autofocus:"",autocomplete:"off",onKeydown:[e[1]||(e[1]=M(S((...a)=>d.onMessageSend&&d.onMessageSend(...a),["meta"]),["enter"])),e[2]||(e[2]=M(S((...a)=>d.onMessageSend&&d.onMessageSend(...a),["ctrl"]),["enter"]))]},null,544),[[j,i.messageContent]])])])}const _e=u(de,[["render",me],["__file","/app/app/javascript/superadmin_pages/views/playground/Index.vue"]]),ge={__name:"Index",props:{componentData:{type:Object,default:()=>({})}},setup(o,{expose:e}){e();const s=o,n=a=>{var v=[],x=[];return a.forEach(b=>{v.push(b[0]),x.push(b[1])}),{labels:v,datasets:[{type:"bar",backgroundColor:"rgb(31, 147, 255)",yAxisID:"y",label:"Conversations",data:x}]}},i=$(()=>n(s.componentData.chartData)),{accountsCount:d,usersCount:l,inboxesCount:g,conversationsCount:f}=s.componentData,m={props:s,prepareData:n,chartData:i,accountsCount:d,usersCount:l,inboxesCount:g,conversationsCount:f,computed:$,BarChart:E};return Object.defineProperty(m,"__isScriptSetup",{enumerable:!1,value:!0}),m}},fe={class:"w-full h-full"},he={class:"main-content__body main-content__body--flush"},ye={class:"report--list"},ve={class:"report-card"},xe={class:"metric"},be={class:"report-card"},we={class:"metric"},Me={class:"report-card"},Se={class:"metric"},$e={class:"report-card"},Ce={class:"metric"};function ke(o,e,s,n,i,d){return c(),p("div",fe,[e[4]||(e[4]=t("header",{class:"main-content__header",role:"banner"},[t("h1",{id:"page-title",class:"main-content__page-title"},r("Admin Dashboard"))],-1)),t("section",he,[t("div",ye,[t("div",ve,[t("div",xe,r(n.accountsCount),1),e[0]||(e[0]=t("div",null,r("Accounts"),-1))]),t("div",be,[t("div",we,r(n.usersCount),1),e[1]||(e[1]=t("div",null,r("Users"),-1))]),t("div",Me,[t("div",Se,r(n.inboxesCount),1),e[2]||(e[2]=t("div",null,r("Inboxes"),-1))]),t("div",$e,[t("div",Ce,r(n.conversationsCount),1),e[3]||(e[3]=t("div",null,r("Conversations"),-1))])])]),I(" eslint-disable vue/no-static-inline-styles "),k(n.BarChart,{class:"p-8 w-full",collection:n.chartData,style:{"max-height":"500px"}},null,8,["collection"])])}const Ie=u(ge,[["render",ke],["__file","/app/app/javascript/superadmin_pages/views/dashboard/Index.vue"]]),Te={PlaygroundIndex:_e,DashboardIndex:Ie},De=(o,e)=>{const s=B({data(){return{props:e}},render(){return P(Te[o],{componentData:this.props})}});s.use(O),s.mount("#app")};document.addEventListener("DOMContentLoaded",()=>{const o=document.getElementById("app");if(o){const e=o.dataset.componentName,s=JSON.parse(o.dataset.props);De(e,s)}});
