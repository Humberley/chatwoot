import{e as u,m as y}from"./useBranding-C51QoB-t.js";import{c as f,O as E,a as v,i as N}from"./widget-DTIWWfiN.js";import{F as S}from"./module-WEXc1Yw_.js";import{u as A}from"./vue-dompurify-html-CEAHYyWB.js";import{A as U}from"./index-DzK6ljgP.js";import{_ as b,x as g,H as I,n as c,o,p as n,g as C,i as m,e as p,m as _,t as h,F as x,j as k,a as V,z as F,q as B}from"./_plugin-vue_export-helper-n_vHXFlc.js";import{i as O}from"./colorHelper-DkkSNPxc.js";const L={name:"UnreadMessage",components:{Avatar:U},mixins:[f],props:{message:{type:String,default:""},showSender:{type:Boolean,default:!1},sender:{type:Object,default:()=>{}},campaignId:{type:Number,default:null}},setup(){const{formatMessage:e,getPlainText:s,truncateMessage:r,highlightContent:i}=A();return{formatMessage:e,getPlainText:s,truncateMessage:r,highlightContent:i}},computed:{companyName(){return`${this.$t("UNREAD_VIEW.COMPANY_FROM")} ${this.channelConfig.websiteName}`},avatarUrl(){const e=this.useInboxAvatarForBot?this.inboxAvatarUrl:"/assets/images/chatwoot_bot.png";if(this.isSenderExist(this.sender)){const{avatar_url:s}=this.sender;return s}return e},agentName(){if(this.isSenderExist(this.sender)){const{available_name:e}=this.sender;return e}return this.useInboxAvatarForBot?this.channelConfig.websiteName:this.$t("UNREAD_VIEW.BOT")},availabilityStatus(){if(this.isSenderExist(this.sender)){const{availability_status:e}=this.sender;return e}return null}},methods:{isSenderExist(e){return e&&!N(e)},onClickMessage(){this.campaignId?u.emit(E,this.campaignId):u.emit(v)}}},D={class:"chat-bubble-wrap"},T={key:0,class:"row--agent-block"},W={class:"agent--name"},z={class:"company--name"},G={class:"message-content"};function R(e,s,r,i,M,t){const d=g("Avatar"),l=I("dompurify-html");return o(),c("div",D,[n("button",{class:"chat-bubble agent bg-white",onClick:s[0]||(s[0]=(...a)=>t.onClickMessage&&t.onClickMessage(...a))},[r.showSender?(o(),c("div",T,[p(d,{src:t.avatarUrl,size:20,name:t.agentName,status:t.availabilityStatus,"rounded-full":""},null,8,["src","name","status"]),m(n("span",W,null,512),[[l,t.agentName]]),m(n("span",z,null,512),[[l,t.companyName]])])):C("v-if",!0),m(n("div",G,null,512),[[l,i.formatMessage(r.message,!1)]])])])}const j=b(L,[["render",R],["__scopeId","data-v-b8f5aeb8"],["__file","/app/app/javascript/widget/components/UnreadMessage.vue"]]),$={name:"Unread",components:{FluentIcon:S,UnreadMessage:j},mixins:[f],props:{messages:{type:Array,required:!0}},emits:["close"],computed:{...y({unreadMessageCount:"conversation/getUnreadMessageCount",widgetColor:"appConfig/getWidgetColor"}),sender(){const[e]=this.messages;return e.sender||{}},isBackgroundLighter(){return O(this.widgetColor)}},methods:{openConversationView(){u.emit(v)},closeFullView(){this.$emit("close")},getMessageContent(e){const{attachments:s,content:r}=e,i=s&&s.length;return r||(i?"ðŸ“‘":"")}}},P={class:"unread-wrap",dir:"ltr"},q={class:"close-unread-wrap"},K={class:"flex items-center"},H={class:"unread-messages"},Y={class:"open-read-view-wrap"};function J(e,s,r,i,M,t){const d=g("FluentIcon"),l=g("UnreadMessage");return o(),c("div",P,[n("div",q,[n("button",{class:"button small close-unread-button",onClick:s[0]||(s[0]=(...a)=>t.closeFullView&&t.closeFullView(...a))},[n("span",K,[p(d,{class:"mr-1",icon:"dismiss",size:"12"}),_(" "+h(e.$t("UNREAD_VIEW.CLOSE_MESSAGES_BUTTON")),1)])])]),n("div",H,[(o(!0),c(x,null,k(r.messages,(a,w)=>(o(),V(l,{key:a.id,"message-type":a.messageType,"message-id":a.id,"show-sender":!w,sender:a.sender,message:t.getMessageContent(a),"campaign-id":a.campaignId},null,8,["message-type","message-id","show-sender","sender","message","campaign-id"]))),128))]),n("div",Y,[e.unreadMessageCount?(o(),c("button",{key:0,class:"button clear-button",onClick:s[1]||(s[1]=(...a)=>t.openConversationView&&t.openConversationView(...a))},[n("span",{class:B(["flex items-center",{"!text-n-slate-12":t.isBackgroundLighter}]),style:F({color:e.widgetColor})},[p(d,{class:"mr-2",size:"16",icon:"arrow-right"}),_(" "+h(e.$t("UNREAD_VIEW.VIEW_MESSAGES_BUTTON")),1)],6)])):C("v-if",!0)])])}const ne=b($,[["render",J],["__scopeId","data-v-3b9ac3c6"],["__file","/app/app/javascript/widget/components/UnreadMessageList.vue"]]);export{ne as U};
