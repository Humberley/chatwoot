import{A as H,I as S,u as x,c as B}from"./widget-DTIWWfiN.js";import{j as T}from"./sharedFrameEvents-0qZ2yOho.js";import{c as v,b as $,u as O,m as P}from"./useBranding-C51QoB-t.js";import{_ as g,n as d,o as s,e as C,p as c,t as A,z as L,F as z,j as W,a as b,c as _,ag as U,w as I,K as M,g as N,x as R}from"./_plugin-vue_export-helper-n_vHXFlc.js";import{ah as k}from"./Validators-0vUS0OnA.js";import"./vue-dompurify-html-CEAHYyWB.js";import"./_commonjsHelpers-BosuxZz1.js";import"./utils.esm-CMazHLgs.js";import"./constants-lVAyZKq6.js";import"./index-DzK6ljgP.js";import"./index-DN3rM4CW.js";import"./Icon-D1o1yyYK.js";import"./Branding-CCCFOlLc.js";import"./module-WEXc1Yw_.js";const D={__name:"TeamAvailability",props:{availableAgents:{type:Array,default:()=>[]},hasConversation:{type:Boolean,default:!1}},emits:["startConversation"],setup(n,{expose:t,emit:r}){t();const e=n,a=r,o=v("appConfig/getWidgetColor"),p={props:e,emit:a,widgetColor:o,startConversation:()=>{a("startConversation"),e.hasConversation||S.sendMessage({event:"onEvent",eventIdentifier:T,data:{hasConversation:!1}})},get IFrameHelper(){return S},get CHATWOOT_ON_START_CONVERSATION(){return T},AvailabilityContainer:H,get useMapGetter(){return v}};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}},G={class:"flex flex-col gap-3 w-full shadow outline-1 outline outline-n-container rounded-xl bg-n-background dark:bg-n-solid-2 px-5 py-4"};function q(n,t,r,e,a,o){return s(),d("div",G,[C(e.AvailabilityContainer,{agents:r.availableAgents,"show-header":"","show-avatars":""},null,8,["agents"]),c("button",{class:"inline-flex items-center gap-1 font-medium text-n-slate-12",style:L({color:e.widgetColor}),onClick:e.startConversation},[c("span",null,A(r.hasConversation?n.$t("CONTINUE_CONVERSATION"):n.$t("START_CONVERSATION")),1),t[0]||(t[0]=c("i",{class:"i-lucide-chevron-right size-5 mt-px"},null,-1))],4)])}const K=g(D,[["render",q],["__file","/app/app/javascript/widget/components/TeamAvailability.vue"]]),J={__name:"ArticleListItem",props:{link:{type:String,default:""},title:{type:String,default:""}},emits:["selectArticle"],setup(n,{expose:t,emit:r}){t();const e=n,a=r,i={props:e,emit:a,onClick:()=>{a("selectArticle",e.link)}};return Object.defineProperty(i,"__isScriptSetup",{enumerable:!1,value:!0}),i}},Q={class:"underline-offset-2 leading-6 ltr:text-left rtl:text-right text-base"};function X(n,t,r,e,a,o){return s(),d("div",{class:"flex items-center justify-between rounded cursor-pointer text-n-slate-11 hover:text-n-slate-12 gap-2",role:"button",onClick:e.onClick},[c("button",Q,A(r.title),1),t[0]||(t[0]=c("span",{class:"i-lucide-chevron-right text-base shrink-0"},null,-1))])}const Y=g(J,[["render",X],["__file","/app/app/javascript/widget/components/pageComponents/Home/Article/ArticleListItem.vue"]]),Z={__name:"ArticleBlock",props:{articles:{type:Array,default:()=>[]}},emits:["view","viewAll"],setup(n,{expose:t,emit:r}){t();const e=n,a=r,o=v("appConfig/getWidgetColor"),i=_(()=>e.articles.slice(0,6)),m={props:e,emit:a,widgetColor:o,articlesToDisplay:i,onArticleClick:l=>{a("view",l)},computed:_,ArticleListItem:Y,get useMapGetter(){return v}};return Object.defineProperty(m,"__isScriptSetup",{enumerable:!1,value:!0}),m}},ee={class:"flex flex-col gap-3"},te={class:"font-medium text-n-slate-12"},ne={class:"flex flex-col gap-4"};function ae(n,t,r,e,a,o){return s(),d("div",ee,[c("h3",te,A(n.$t("PORTAL.POPULAR_ARTICLES")),1),c("div",ne,[(s(!0),d(z,null,W(e.articlesToDisplay,i=>(s(),b(e.ArticleListItem,{key:i.slug,link:i.link,title:i.title,onSelectArticle:e.onArticleClick},null,8,["link","title"]))),128))]),c("div",null,[c("button",{class:"font-medium tracking-wide inline-flex",style:L({color:e.widgetColor}),onClick:t[0]||(t[0]=i=>n.$emit("viewAll"))},[c("span",null,A(n.$t("PORTAL.VIEW_ALL_ARTICLES")),1)],4)])])}const re=g(Z,[["render",ae],["__file","/app/app/javascript/widget/components/pageComponents/Home/Article/ArticleBlock.vue"]]),ie={},oe={class:"py-4 space-y-4"};function se(n,t){return s(),d("div",oe,t[0]||(t[0]=[U('<div class="space-y-2 animate-pulse"><div class="h-6 bg-n-slate-5 dark:bg-n-alpha-black1 rounded w-2/5"></div></div><div class="space-y-2 animate-pulse"><div class="h-4 bg-n-slate-5 dark:bg-n-alpha-black1 rounded"></div><div class="h-4 bg-n-slate-5 dark:bg-n-alpha-black1 rounded"></div><div class="h-4 bg-n-slate-5 dark:bg-n-alpha-black1 rounded"></div></div><div class="space-y-2 animate-pulse"><div class="h-4 bg-n-slate-5 dark:bg-n-alpha-black1 rounded w-1/5"></div></div>',3)]))}const le=g(ie,[["render",se],["__file","/app/app/javascript/widget/components/pageComponents/Home/Article/SkeletonLoader.vue"]]),j=(n="",t=[])=>{if(!n||!Array.isArray(t)||!t.length)return null;const[r]=n.split("_");return[n,r,t.find(a=>a.startsWith(`${r}_`))].find(a=>a&&t.includes(a))??null},ce={__name:"ArticleContainer",setup(n,{expose:t}){t();const r=$(),e=k(),a=O(),{prefersDarkMode:o}=x(),i=_(()=>window.chatwootWebChannel.portal),p=v("article/popularArticles"),m=v("article/uiFlags"),l=_(()=>{const{locale:u}=a;if(!i.value||!i.value.config)return null;const{allowed_locales:f}=i.value.config;return j(u.value,f)}),h=()=>{i.value&&l.value&&r.dispatch("article/fetch",{slug:i.value.slug,locale:l.value})},y=u=>{const f=new URLSearchParams({show_plain_layout:"true",theme:o.value?"dark":"light",...l.value&&{locale:l.value}}),F=`${u}?${f.toString()}`;e.push({name:"article-viewer",query:{link:F}})},V=()=>{const{portal:{slug:u}}=window.chatwootWebChannel;y(`/hc/${u}/${l.value}`)},E=_(()=>!m.value.isFetching&&!m.value.isError&&!!p.value.length&&!!l.value);I(l,(u,f)=>{u&&u!==f&&h()}),M(()=>h());const w={store:r,router:e,i18n:a,prefersDarkMode:o,portal:i,popularArticles:p,articleUiFlags:m,locale:l,fetchArticles:h,openArticleInArticleViewer:y,viewAllArticles:V,hasArticles:E,computed:_,onMounted:M,watch:I,ArticleBlock:re,ArticleCardSkeletonLoader:le,get useI18n(){return O},get useRouter(){return k},get useStore(){return $},get useMapGetter(){return v},get useDarkMode(){return x},get getMatchingLocale(){return j}};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}},pe={key:0,class:"w-full shadow outline-1 outline outline-n-container rounded-xl bg-n-background dark:bg-n-solid-2 px-5 py-4"},ue={key:1,class:"hidden"};function de(n,t,r,e,a,o){return e.portal&&(e.articleUiFlags.isFetching||e.popularArticles.length)?(s(),d("div",pe,[e.hasArticles?(s(),b(e.ArticleBlock,{key:0,articles:e.popularArticles,onView:e.openArticleInArticleViewer,onViewAll:e.viewAllArticles},null,8,["articles"])):N("v-if",!0),e.articleUiFlags.isFetching?(s(),b(e.ArticleCardSkeletonLoader,{key:1})):N("v-if",!0)])):(s(),d("div",ue))}const ve=g(ce,[["render",de],["__file","/app/app/javascript/widget/components/pageComponents/Home/Article/ArticleContainer.vue"]]),me={name:"Home",components:{ArticleContainer:ve,TeamAvailability:K},mixins:[B],setup(){return{router:k()}},computed:{...P({availableAgents:"agent/availableAgents",conversationSize:"conversation/getConversationSize",unreadMessageCount:"conversation/getUnreadMessageCount"})},methods:{startConversation(){return this.preChatFormEnabled&&!this.conversationSize?this.router.replace({name:"prechat-form"}):this.router.replace({name:"messages"})}}},_e={class:"z-50 flex flex-col justify-end flex-1 w-full p-4 gap-4"};function ge(n,t,r,e,a,o){const i=R("TeamAvailability"),p=R("ArticleContainer");return s(),d("div",_e,[C(i,{"available-agents":n.availableAgents,"has-conversation":!!n.conversationSize,"unread-count":n.unreadMessageCount,onStartConversation:o.startConversation},null,8,["available-agents","has-conversation","unread-count","onStartConversation"]),C(p)])}const Me=g(me,[["render",ge],["__file","/app/app/javascript/widget/views/Home.vue"]]);export{Me as default};
