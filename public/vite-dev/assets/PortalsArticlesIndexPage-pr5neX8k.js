import{_ as V,a as S,o as m,l as k,p as G,q as ce,r as B,c as s,w as F,n as U,e as N,g as D,F as ie,j as ue,K as $}from"./_plugin-vue_export-helper-n_vHXFlc.js";import{ai as ee,ah as Y,u as M}from"./Validators-0vUS0OnA.js";import{b as z,u as j,c as E}from"./useBranding-C51QoB-t.js";import{A as oe,g as K,D as ge,u as te,a as ae,b as W,C as J,c as de,T as pe,E as me,d as Ae,l as re}from"./dashboard-DaT-cgYc.js";import{H as _e}from"./HelpCenterLayout-CP5dHFgN.js";import{a as Q,u as q}from"./index-CQMLlWJA.js";import{bU as X,bM as Ce}from"./DashboardIcon-CCM-1oGA.js";import{B as le,S as he}from"./index-UYK3fwMr.js";import{C as ye}from"./CategoryHeaderControls-DpYgORUR.js";import"./index-DN3rM4CW.js";import"./_commonjsHelpers-BosuxZz1.js";import"./utils.esm-CMazHLgs.js";import"./index-DzK6ljgP.js";import"./typing-Dhk99rRl.js";import"./vue-dompurify-html-CEAHYyWB.js";import"./useKeyboardNavigableList-B1kK16iE.js";import"./helper-BVTgYTlr.js";import"./Icon-D1o1yyYK.js";import"./module-WEXc1Yw_.js";import"./BarChart-BLu1KVZQ.js";import"./constants-lVAyZKq6.js";import"./IframeLoader-DfGHvGaO.js";import"./js.cookie-Cz0CWeBA.js";const Ee={__name:"ArticleList",props:{articles:{type:Array,required:!0},isCategoryArticles:{type:Boolean,default:!1}},setup(h,{expose:c}){c();const a=h,{ARTICLE_STATUS_TYPES:e}=ee,i=Y(),n=M(),r=z(),{t:_}=j(),A=B(a.articles),y=s(()=>{var o;return a.isCategoryArticles&&((o=A.value)==null?void 0:o.length)>1}),f=E("categories/categoryById"),v=o=>{const{tab:u,categorySlug:t,locale:l}=n.params;a.isCategoryArticles?i.push({name:"portals_categories_articles_edit",params:{articleSlug:o}}):i.push({name:"portals_articles_edit",params:{articleSlug:o,tab:u,categorySlug:t,locale:l}})},T=o=>{r.dispatch("articles/reorder",{reorderedGroup:o,portalSlug:n.params.portalSlug})},w=()=>{const o=A.value.map(l=>l.position).sort((l,g)=>l-g),t=A.value.map(l=>l.id).reduce((l,g,p)=>(l[g]=o[p],l),{});T(t)},I=o=>f.value(o)||{name:"",icon:""},C=(o,u)=>{const t=u?"SUCCESS":"ERROR",l={[e.PUBLISH]:"PUBLISH_ARTICLE",[e.ARCHIVE]:"ARCHIVE_ARTICLE",[e.DRAFT]:"DRAFT_ARTICLE"};return l[o]?_(`HELP_CENTER.${l[o]}.API.${t}`):""},L=()=>{const{portalSlug:o,locale:u}=n.params;return r.dispatch("portals/show",{portalSlug:o,locale:u})},R=()=>{const{portalSlug:o,locale:u}=n.params;return r.dispatch("articles/updateArticleMeta",{portalSlug:o,locale:u})},x=async(o,{status:u,id:t})=>{const{portalSlug:l}=n.params;try{o==="delete"?(await r.dispatch("articles/delete",{portalSlug:l,articleId:t}),q(_("HELP_CENTER.DELETE_ARTICLE.API.SUCCESS_MESSAGE"))):(await r.dispatch("articles/update",{portalSlug:l,articleId:t,status:u}),q(C(u,!0)),u===e.ARCHIVE?Q(X.ARCHIVE_ARTICLE,{uiFrom:"header"}):u===e.PUBLISH&&Q(X.PUBLISH_ARTICLE)),await R(),await L()}catch(g){const p=(g==null?void 0:g.message)||(o==="delete"?_("HELP_CENTER.DELETE_ARTICLE.API.ERROR_MESSAGE"):C(u,!1));q(p)}},P=({action:o,value:u,id:t})=>{const l=o!=="delete"?K(u):null;x(o,{status:l,id:t})};F(()=>a.articles,o=>{A.value=o},{deep:!0});const O={props:a,ARTICLE_STATUS_TYPES:e,router:i,route:n,store:r,t:_,localArticles:A,dragEnabled:y,getCategoryById:f,openArticle:v,onReorder:T,onDragEnd:w,getCategory:I,getStatusMessage:C,updatePortalMeta:L,updateArticlesMeta:R,handleArticleAction:x,updateArticle:P,ref:B,computed:s,watch:F,get Draggable(){return ge},get useMapGetter(){return E},get useStore(){return z},get useRouter(){return Y},get useRoute(){return M},get useI18n(){return j},get useAlert(){return q},get useTrack(){return Q},get PORTALS_EVENTS(){return X},get getArticleStatus(){return K},get wootConstants(){return ee},ArticleCard:oe};return Object.defineProperty(O,"__isScriptSetup",{enumerable:!1,value:!0}),O}},Se={class:"list-none rounded-2xl"};function fe(h,c,a,e,i,n){return m(),S(e.Draggable,{modelValue:e.localArticles,"onUpdate:modelValue":c[0]||(c[0]=r=>e.localArticles=r),disabled:!e.dragEnabled,"item-key":"id",tag:"ul","ghost-class":"article-ghost-class",class:"w-full h-full space-y-4",onEnd:e.onDragEnd},{item:k(({element:r})=>[G("li",Se,[(m(),S(e.ArticleCard,{id:r.id,key:r.id,title:r.title,status:r.status,author:r.author,category:e.getCategory(r.category.id),views:r.views||0,"updated-at":r.updatedAt,class:ce({"cursor-grab":e.dragEnabled}),onOpenArticle:e.openArticle,onArticleAction:e.updateArticle},null,8,["id","title","status","author","category","views","updated-at","class"]))])]),_:1},8,["modelValue","disabled"])}const ve=V(Ee,[["render",fe],["__scopeId","data-v-e4b14804"],["__file","/app/app/javascript/dashboard/components-next/HelpCenter/Pages/ArticlePage/ArticleList.vue"]]),Le={__name:"ArticleHeaderControls",props:{categories:{type:Array,required:!0},allowedLocales:{type:Array,required:!0},meta:{type:Object,required:!0}},emits:["tabChange","localeChange","categoryChange","newArticle"],setup(h,{expose:c,emit:a}){c();const e=h,i=a,n=M(),{t:r}=j(),{updateUISettings:_}=te(),A=B(!1),y=B(!1),f=t=>t.value==="all"?"articlesCount":`${t.value}ArticlesCount`,v=s(()=>ae.map(t=>({label:r(`HELP_CENTER.ARTICLES_PAGE.ARTICLES_HEADER.TABS.${t.key}`),value:t.value,count:e.meta[f(t)]}))),T=s(()=>{const t=n.params.tab||W.ALL;return v.value.findIndex(l=>l.value===t)}),w=s(()=>{const t=e.categories.find(l=>l.slug===n.params.categorySlug);if(t){const{icon:l,name:g}=t;return`${l} ${g}`}return r("HELP_CENTER.ARTICLES_PAGE.ARTICLES_HEADER.CATEGORY.ALL")}),I=s(()=>{var t;return(t=e.allowedLocales.find(l=>l.code===n.params.locale))==null?void 0:t.name}),C=s(()=>{const t={label:r("HELP_CENTER.ARTICLES_PAGE.ARTICLES_HEADER.CATEGORY.ALL"),value:J,action:"filter"},l=e.categories.map(p=>({label:p.name,value:p.slug,action:"filter",emoji:p.icon}));return!!n.params.categorySlug?[t,...l]:l}),L=s(()=>{var t;return((t=C.value)==null?void 0:t.length)>0}),R=s(()=>e.allowedLocales.map(t=>({label:t.name,value:t.code,action:"filter"}))),u={props:e,emit:i,route:n,t:r,updateUISettings:_,isCategoryMenuOpen:A,isLocaleMenuOpen:y,countKey:f,tabs:v,activeTabIndex:T,activeCategoryName:w,activeLocaleName:I,categoryMenuItems:C,hasCategoryMenuItems:L,localeMenuItems:R,handleLocaleAction:({value:t})=>{i("localeChange",t),y.value=!1,_({last_active_locale_code:t})},handleCategoryAction:({value:t})=>{i("categoryChange",t),A.value=!1},handleNewArticle:()=>{i("newArticle")},handleTabChange:t=>{i("tabChange",t)},ref:B,computed:s,get useI18n(){return j},get useRoute(){return M},get OnClickOutside(){return Ce},get useUISettings(){return te},get ARTICLE_TABS(){return W},get CATEGORY_ALL(){return J},get ARTICLE_TABS_OPTIONS(){return ae},TabBar:pe,Button:le,DropdownMenu:de};return Object.defineProperty(u,"__isScriptSetup",{enumerable:!1,value:!0}),u}},Te={class:"flex flex-col items-start w-full gap-2 lg:flex-row"},be={class:"flex items-start justify-between w-full gap-2"},Pe={class:"flex items-center gap-2"},we={class:"relative group"},Ie={key:0,class:"relative group"};function Re(h,c,a,e,i,n){return m(),U("div",Te,[N(e.TabBar,{tabs:e.tabs,"initial-active-tab":e.activeTabIndex,onTabChanged:e.handleTabChange},null,8,["tabs","initial-active-tab"]),G("div",be,[G("div",Pe,[G("div",we,[N(e.OnClickOutside,{onTrigger:c[1]||(c[1]=r=>e.isLocaleMenuOpen=!1)},{default:k(()=>[N(e.Button,{label:e.activeLocaleName,size:"sm",icon:"i-lucide-chevron-down",color:"slate","trailing-icon":"",onClick:c[0]||(c[0]=r=>e.isLocaleMenuOpen=!e.isLocaleMenuOpen)},null,8,["label"]),e.isLocaleMenuOpen?(m(),S(e.DropdownMenu,{key:0,"menu-items":e.localeMenuItems,"show-search":"",class:"left-0 w-40 max-w-[300px] mt-2 overflow-y-auto xl:right-0 top-full max-h-60",onAction:e.handleLocaleAction},null,8,["menu-items"])):D("v-if",!0)]),_:1})]),e.hasCategoryMenuItems?(m(),U("div",Ie,[N(e.OnClickOutside,{onTrigger:c[3]||(c[3]=r=>e.isCategoryMenuOpen=!1)},{default:k(()=>[N(e.Button,{label:e.activeCategoryName,icon:"i-lucide-chevron-down",size:"sm",color:"slate","trailing-icon":"",class:"max-w-48",onClick:c[2]||(c[2]=r=>e.isCategoryMenuOpen=!e.isCategoryMenuOpen)},null,8,["label"]),e.isCategoryMenuOpen?(m(),S(e.DropdownMenu,{key:0,"menu-items":e.categoryMenuItems,"show-search":"",class:"left-0 w-48 mt-2 overflow-y-auto xl:right-0 top-full max-h-60",onAction:e.handleCategoryAction},null,8,["menu-items"])):D("v-if",!0)]),_:1})])):D("v-if",!0)]),N(e.Button,{label:e.t("HELP_CENTER.ARTICLES_PAGE.ARTICLES_HEADER.NEW_ARTICLE"),icon:"i-lucide-plus",size:"sm",onClick:e.handleNewArticle},null,8,["label"])])])}const xe=V(Le,[["render",Re],["__file","/app/app/javascript/dashboard/components-next/HelpCenter/Pages/ArticlePage/ArticleHeaderControls.vue"]]),Ne={__name:"ArticleEmptyState",props:{title:{type:String,default:""},subtitle:{type:String,default:""},showButton:{type:Boolean,default:!0},buttonLabel:{type:String,default:""}},emits:["click"],setup(h,{expose:c,emit:a}){c();const e=a,n={emit:e,onClick:()=>{e("click")},EmptyStateLayout:me,Button:le,ArticleCard:oe,get articleContent(){return Ae}};return Object.defineProperty(n,"__isScriptSetup",{enumerable:!1,value:!0}),n}},Me={class:"grid grid-cols-1 gap-4 p-px overflow-hidden"},Oe={key:0};function He(h,c,a,e,i,n){return m(),S(e.EmptyStateLayout,{title:a.title,subtitle:a.subtitle},{"empty-state-item":k(()=>[G("div",Me,[(m(!0),U(ie,null,ue(e.articleContent.slice(0,5),(r,_)=>(m(),S(e.ArticleCard,{id:r.id,key:`article-${_}`,title:r.title,status:r.status,"updated-at":r.updatedAt,author:r.author,category:r.category,views:r.views},null,8,["id","title","status","updated-at","author","category","views"]))),128))])]),actions:k(()=>[a.showButton?(m(),U("div",Oe,[N(e.Button,{label:a.buttonLabel,icon:"i-lucide-plus",onClick:e.onClick},null,8,["label"])])):D("v-if",!0)]),_:1},8,["title","subtitle"])}const Be=V(Ne,[["render",He],["__file","/app/app/javascript/dashboard/components-next/HelpCenter/EmptyState/Article/ArticleEmptyState.vue"]]),ke={__name:"ArticlesPage",props:{articles:{type:Array,required:!0},categories:{type:Array,required:!0},allowedLocales:{type:Array,required:!0},portalName:{type:String,required:!0},meta:{type:Object,required:!0},isCategoryArticles:{type:Boolean,default:!1}},emits:["pageChange","fetchPortal"],setup(h,{expose:c,emit:a}){c();const e=h,i=a,n=Y(),r=M(),{t:_}=j(),A=E("portals/isSwitchingPortal"),y=E("articles/isFetching"),f=s(()=>!y.value&&!e.articles.length),v=s(()=>y.value||A.value),T=s(()=>e.meta.allArticlesCount),w=s(()=>T.value===0&&!e.isCategoryArticles),I=s(()=>!(y.value||A.value||f.value)),C=d=>{const{portalSlug:b,locale:H,tab:se,categorySlug:ne}=r.params;n.push({name:"portals_articles_index",params:{portalSlug:b,locale:d.locale??H,tab:d.tab??se,categorySlug:d.categorySlug??ne,...d}})},L=s(()=>{const{tab:d}=r.params,{meta:b}=e,H={"":b.articlesCount,mine:b.mineArticlesCount,draft:b.draftArticlesCount,archived:b.archivedArticlesCount};return Number(H[d]||H[""])}),R=s(()=>!e.isCategoryArticles&&!A.value),x=s(()=>e.isCategoryArticles&&!A.value),P=d=>{var H;if(e.isCategoryArticles)return _(`HELP_CENTER.ARTICLES_PAGE.EMPTY_STATE.CATEGORY.${d}`);const b=((H=r.params.tab)==null?void 0:H.toUpperCase())||"ALL";return _(`HELP_CENTER.ARTICLES_PAGE.EMPTY_STATE.${b}.${d}`)},O=s(()=>P("TITLE")),o=s(()=>P("SUBTITLE")),Z={props:e,emit:i,router:n,route:r,t:_,isSwitchingPortal:A,isFetching:y,hasNoArticles:f,isLoading:v,totalArticlesCount:T,hasNoArticlesInPortal:w,shouldShowPaginationFooter:I,updateRoute:C,articlesCount:L,showArticleHeaderControls:R,showCategoryHeaderControls:x,getEmptyStateText:P,getEmptyStateTitle:O,getEmptyStateSubtitle:o,handleTabChange:d=>C({tab:d.value===W.ALL?"":d.value}),handleCategoryAction:d=>C({categorySlug:d===J?"":d}),handleLocaleAction:d=>{C({locale:d,categorySlug:""}),i("fetchPortal",d)},handlePageChange:d=>i("pageChange",d),navigateToNewArticlePage:()=>{const{categorySlug:d,locale:b}=r.params;n.push({name:"portals_articles_new",params:{categorySlug:d,locale:b}})},computed:s,get useRouter(){return Y},get useRoute(){return M},get useI18n(){return j},get useMapGetter(){return E},get ARTICLE_TABS(){return W},get CATEGORY_ALL(){return J},HelpCenterLayout:_e,ArticleList:ve,ArticleHeaderControls:xe,CategoryHeaderControls:ye,Spinner:he,ArticleEmptyState:Be};return Object.defineProperty(Z,"__isScriptSetup",{enumerable:!1,value:!0}),Z}},Ge={class:"flex items-end justify-between"},De={key:0,class:"flex items-center justify-center py-10 text-n-slate-11"};function Ue(h,c,a,e,i,n){return m(),S(e.HelpCenterLayout,{"current-page":Number(a.meta.currentPage),"total-items":e.articlesCount,"items-per-page":25,header:a.portalName,"show-pagination-footer":e.shouldShowPaginationFooter,"onUpdate:currentPage":e.handlePageChange},{"header-actions":k(()=>[G("div",Ge,[e.showArticleHeaderControls?(m(),S(e.ArticleHeaderControls,{key:0,categories:a.categories,"allowed-locales":a.allowedLocales,meta:a.meta,onTabChange:e.handleTabChange,onLocaleChange:e.handleLocaleAction,onCategoryChange:e.handleCategoryAction,onNewArticle:e.navigateToNewArticlePage},null,8,["categories","allowed-locales","meta"])):e.showCategoryHeaderControls?(m(),S(e.CategoryHeaderControls,{key:1,categories:a.categories,"allowed-locales":a.allowedLocales,"has-selected-category":a.isCategoryArticles},null,8,["categories","allowed-locales","has-selected-category"])):D("v-if",!0)])]),content:k(()=>[e.isLoading?(m(),U("div",De,[N(e.Spinner)])):e.hasNoArticles?(m(),S(e.ArticleEmptyState,{key:2,class:"pt-14",title:e.getEmptyStateTitle,subtitle:e.getEmptyStateSubtitle,"show-button":e.hasNoArticlesInPortal,"button-label":e.t("HELP_CENTER.ARTICLES_PAGE.EMPTY_STATE.ALL.BUTTON_LABEL"),onClick:e.navigateToNewArticlePage},null,8,["title","subtitle","show-button","button-label"])):(m(),S(e.ArticleList,{key:1,articles:a.articles,"is-category-articles":a.isCategoryArticles},null,8,["articles","is-category-articles"]))]),_:1},8,["current-page","total-items","header","show-pagination-footer"])}const je=V(ke,[["render",Ue],["__file","/app/app/javascript/dashboard/components-next/HelpCenter/Pages/ArticlePage/ArticlesPage.vue"]]),Ve={__name:"PortalsArticlesIndexPage",setup(h,{expose:c}){c();const a=M(),e=z(),i=B(1),n=E("articles/allArticles"),r=E("categories/allCategories"),_=E("articles/getMeta"),A=E("portals/getMeta"),y=E("getCurrentUserID"),f=E("portals/portalBySlug"),v=s(()=>a.params.portalSlug),T=s(()=>a.params.categorySlug),w=s(()=>K(a.params.tab)),I=s(()=>a.params.tab==="mine"?y.value:null),C=s(()=>a.params.locale),L=s(()=>f.value(v.value)),R=s(()=>{if(!L.value)return[];const{allowed_locales:g}=L.value.config;return g.map(p=>({id:p.code,name:re[p.code],code:p.code}))}),x=s(()=>{var g,p;return(p=(g=L.value)==null?void 0:g.meta)==null?void 0:p.default_locale}),P=s(()=>a.params.locale||x.value),O=s(()=>a.name==="portals_categories_articles_index"||a.name==="portals_categories_articles_edit"||a.name==="portals_categories_index"),o=({pageNumber:g}={})=>{e.dispatch("articles/index",{pageNumber:g||i.value,portalSlug:v.value,locale:C.value,status:w.value,authorId:I.value,categorySlug:T.value})},u=g=>{o({pageNumber:g})},t=async g=>{await e.dispatch("portals/index");const p={portalSlug:v.value,locale:g||P.value};e.dispatch("portals/show",p),e.dispatch("categories/index",p),e.dispatch("agents/get")};$(()=>{o()}),F(()=>a.params,()=>{i.value=1,o()},{deep:!0,immediate:!0});const l={route:a,store:e,pageNumber:i,articles:n,categories:r,meta:_,portalMeta:A,currentUserId:y,getPortalBySlug:f,selectedPortalSlug:v,selectedCategorySlug:T,status:w,author:I,activeLocale:C,portal:L,allowedLocales:R,defaultPortalLocale:x,selectedLocaleInPortal:P,isCategoryArticles:O,fetchArticles:o,onPageChange:u,fetchPortalAndItsCategories:t,computed:s,ref:B,onMounted:$,watch:F,get useRoute(){return M},get useMapGetter(){return E},get useStore(){return z},get allLocales(){return re},get getArticleStatus(){return K},ArticlesPage:je};return Object.defineProperty(l,"__isScriptSetup",{enumerable:!1,value:!0}),l}},qe={class:"w-full h-full"};function Fe(h,c,a,e,i,n){return m(),U("div",qe,[e.portal?(m(),S(e.ArticlesPage,{key:0,articles:e.articles,"portal-name":e.portal.name,categories:e.categories,"allowed-locales":e.allowedLocales,meta:e.meta,"portal-meta":e.portalMeta,"is-category-articles":e.isCategoryArticles,onPageChange:e.onPageChange,onFetchPortal:e.fetchPortalAndItsCategories},null,8,["articles","portal-name","categories","allowed-locales","meta","portal-meta","is-category-articles"])):D("v-if",!0)])}const mt=V(Ve,[["render",Fe],["__file","/app/app/javascript/dashboard/routes/dashboard/helpcenter/pages/PortalsArticlesIndexPage.vue"]]);export{mt as default};
