import{u as N,b as K,a as oe,c as y}from"./useBranding-C51QoB-t.js";import{as as ae,u as X,ah as ne}from"./Validators-0vUS0OnA.js";import{v as ge,q as Ee,p as ee,r as Te,u as le}from"./dashboard-DaT-cgYc.js";import{u as O}from"./index-CQMLlWJA.js";import{bM as Se,aX as se,aS as te,cb as Y,c as ie,f as J}from"./DashboardIcon-CCM-1oGA.js";import{_ as M,n as v,o as R,e as u,l as w,a as G,g as U,p as l,z as Re,t as g,r as P,W as H,c as m,w as Z,f as fe,H as pe,i as Oe,q as Q}from"./_plugin-vue_export-helper-n_vHXFlc.js";import{H as Pe}from"./HelpCenterLayout-CP5dHFgN.js";import{s as re}from"./typing-Dhk99rRl.js";import{B as W,c as V,r as j,u as k,a as de,m as ce,e as _e,S as Ce}from"./index-UYK3fwMr.js";import{A as Ne}from"./index-DzK6ljgP.js";import{B as ue}from"./utils.esm-CMazHLgs.js";import"./index-DN3rM4CW.js";import"./_commonjsHelpers-BosuxZz1.js";import"./useKeyboardNavigableList-B1kK16iE.js";import"./helper-BVTgYTlr.js";import"./Icon-D1o1yyYK.js";import"./vue-dompurify-html-CEAHYyWB.js";import"./module-WEXc1Yw_.js";import"./BarChart-BLu1KVZQ.js";import"./constants-lVAyZKq6.js";import"./IframeLoader-DfGHvGaO.js";import"./js.cookie-Cz0CWeBA.js";const Ie={__name:"ColorPicker",props:{modelValue:{type:String,default:""}},emits:["update:modelValue"],setup(S,{expose:o,emit:d}){o();const e=d,i=P(!1),s=()=>{i.value=!i.value},a=()=>{i.value&&s()},_=f=>{e("update:modelValue",f.hex)},r=P(null),E={emit:e,isPickerOpen:i,toggleColorPicker:s,closeTogglePicker:a,updateColor:_,pickerRef:r,ref:P,get Chrome(){return ge.Chrome},get OnClickOutside(){return Se},Button:W};return Object.defineProperty(E,"__isScriptSetup",{enumerable:!1,value:!0}),E}},Ae={ref:"pickerRef",class:"relative w-fit"},Le={class:"flex items-center flex-grow gap-2"},he={class:"min-w-0 truncate"};function ve(S,o,d,e,i,s){return R(),v("div",Ae,[u(e.OnClickOutside,{onTrigger:e.closeTogglePicker},{default:w(()=>[u(e.Button,{color:"slate",icon:"i-lucide-pipette","trailing-icon":"",class:"!px-3 !py-3 [&>svg]:w-4 [&>svg]:h-4",onClick:e.toggleColorPicker},{default:w(()=>[l("div",Le,[l("span",{class:"rounded-md size-4",style:Re({backgroundColor:d.modelValue})},null,4),l("span",he,g(d.modelValue),1)])]),_:1}),e.isPickerOpen?(R(),G(e.Chrome,{key:0,"disable-alpha":"","model-value":d.modelValue,class:"colorpicker--chrome","onUpdate:modelValue":e.updateColor},null,8,["model-value"])):U("v-if",!0)]),_:1})],512)}const De=M(Ie,[["render",ve],["__scopeId","data-v-9551daa3"],["__file","/app/app/javascript/dashboard/components-next/colorpicker/ColorPicker.vue"]]),$=4,xe={__name:"PortalBaseSettings",props:{activePortal:{type:Object,required:!0},isFetching:{type:Boolean,default:!1}},emits:["updatePortal"],setup(S,{expose:o,emit:d}){o();const e=S,i=d,{t:s}=N(),a=K(),_=oe(),r=H({name:"",headerText:"",pageTitle:"",slug:"",widgetColor:"",homePageLink:"",liveChatWidgetInboxId:"",logoUrl:"",avatarBlobId:""}),E=H({...r}),f=m(()=>{const n=a.getters["inboxes/getInboxes"].filter(c=>c.channel_type==="Channel::WebWidget").map(c=>({value:c.id,label:c.name}));return[{value:"",label:s("HELP_CENTER.PORTAL_SETTINGS.FORM.LIVE_CHAT_WIDGET.NONE_OPTION")},...n]}),p={name:{required:j,minLength:ce(2)},slug:{required:V.withMessage(()=>s("HELP_CENTER.CREATE_PORTAL_DIALOG.SLUG.ERROR"),j),isValidSlug:V.withMessage(()=>s("HELP_CENTER.CREATE_PORTAL_DIALOG.SLUG.FORMAT_ERROR"),ae)},homePageLink:{url:de}},T=k(p,r),h=m(()=>T.value.name.$error?s("HELP_CENTER.CREATE_PORTAL_DIALOG.NAME.ERROR"):""),I=m(()=>{var t;return((t=T.value.slug.$errors[0])==null?void 0:t.$message)||""}),D=m(()=>T.value.homePageLink.$error?s("HELP_CENTER.PORTAL_SETTINGS.FORM.HOME_PAGE_LINK.ERROR"):""),L=m(()=>{var n,c;const t=(n=e.activePortal)==null?void 0:n.slug;return t?(c=_["portals/uiFlagsIn"].value(t))==null?void 0:c.isUpdating:!1});Z(()=>e.activePortal,t=>{var n;if(t&&!e.isFetching){if(Object.assign(r,{name:t.name,headerText:t.header_text,pageTitle:t.page_title,widgetColor:t.color,homePageLink:t.homepage_link,slug:t.slug,liveChatWidgetInboxId:((n=t.inbox)==null?void 0:n.id)||""}),t.logo){const{logo:{file_url:c,blob_id:z}}=t;r.logoUrl=c,r.avatarBlobId=z}else r.logoUrl="",r.avatarBlobId="";Object.assign(E,r)}},{immediate:!0,deep:!0});const A=m(()=>JSON.stringify(r)!==JSON.stringify(E)),x=()=>{var n;const t={id:(n=e.activePortal)==null?void 0:n.id,slug:r.slug,name:r.name,color:r.widgetColor,page_title:r.pageTitle,header_text:r.headerText,homepage_link:r.homePageLink,blob_id:r.avatarBlobId,inbox_id:r.liveChatWidgetInboxId};i("updatePortal",t)};async function B({file:t}){try{const{fileUrl:n,blobId:c}=await se(t);n&&(r.logoUrl=n,r.avatarBlobId=c),O(s("HELP_CENTER.PORTAL_SETTINGS.FORM.AVATAR.IMAGE_UPLOAD_SUCCESS"))}catch{O(s("HELP_CENTER.PORTAL_SETTINGS.FORM.AVATAR.IMAGE_UPLOAD_ERROR"))}}async function F(){var t;try{const n=(t=e.activePortal)==null?void 0:t.slug;await a.dispatch("portals/deleteLogo",{portalSlug:n}),O(s("HELP_CENTER.PORTAL_SETTINGS.FORM.AVATAR.IMAGE_DELETE_SUCCESS"))}catch(n){O((n==null?void 0:n.message)||s("HELP_CENTER.PORTAL_SETTINGS.FORM.AVATAR.IMAGE_DELETE_ERROR"))}}const b={props:e,emit:i,t:s,store:a,getters:_,MAXIMUM_FILE_UPLOAD_SIZE:$,state:r,originalState:E,liveChatWidgets:f,rules:p,v$:T,nameError:h,slugError:I,homePageLinkError:D,isUpdatingPortal:L,hasChanges:A,handleUpdatePortal:x,uploadLogoToStorage:B,deleteLogo:F,handleAvatarUpload:t=>{re(t,$)?B(t):O(s("HELP_CENTER.PORTAL_SETTINGS.FORM.AVATAR.IMAGE_UPLOAD_SIZE_ERROR",{size:$}))},handleAvatarDelete:()=>{r.logoUrl="",r.avatarBlobId="",F()},reactive:H,watch:Z,computed:m,get useI18n(){return N},get buildPortalURL(){return Te},get useAlert(){return O},get useStore(){return K},get useStoreGetters(){return oe},get uploadFile(){return se},get checkFileSizeLimit(){return re},get useVuelidate(){return k},get required(){return j},get minLength(){return ce},get helpers(){return V},get url(){return de},get isValidSlug(){return ae},Button:W,Input:ee,Avatar:Ne,ComboBox:Ee,ColorPicker:De};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}},be={class:"flex flex-col w-full gap-4"},Ue={class:"flex flex-col w-full gap-2"},Ge={class:"mb-0.5 text-sm font-medium text-gray-900 dark:text-gray-50"},Me={class:"flex flex-col w-full gap-4"},Fe={class:"grid items-start justify-between w-full gap-2 grid-cols-[200px,1fr]"},ye={class:"text-sm font-medium whitespace-nowrap py-2.5 text-n-slate-12"},He={class:"grid items-start justify-between w-full gap-2 grid-cols-[200px,1fr]"},we={class:"text-sm font-medium whitespace-nowrap py-2.5 text-n-slate-12"},ke={class:"grid items-start justify-between w-full gap-2 grid-cols-[200px,1fr]"},Be={class:"text-sm font-medium whitespace-nowrap text-n-slate-12 py-2.5"},Ve={class:"grid items-start justify-between w-full gap-2 grid-cols-[200px,1fr]"},je={class:"text-sm font-medium whitespace-nowrap text-n-slate-12 py-2.5"},We={class:"grid items-start justify-between w-full gap-2 grid-cols-[200px,1fr]"},qe={class:"text-sm font-medium whitespace-nowrap py-2.5 text-n-slate-12"},ze={class:"grid items-start justify-between w-full gap-2 grid-cols-[200px,1fr]"},Ke={class:"text-sm font-medium whitespace-nowrap py-2.5 text-n-slate-12"},Xe={class:"grid items-start justify-between w-full gap-2 grid-cols-[200px,1fr]"},Je={class:"text-sm font-medium whitespace-nowrap py-2.5 text-n-slate-12"},Ze={class:"w-[432px] justify-start"},Ye={class:"flex justify-end w-full gap-2"};function Qe(S,o,d,e,i,s){return R(),v("div",be,[l("div",Ue,[l("label",Ge,g(e.t("HELP_CENTER.PORTAL_SETTINGS.FORM.AVATAR.LABEL")),1),u(e.Avatar,{src:e.state.logoUrl,name:e.state.name,size:72,"allow-upload":"","icon-name":"i-lucide-building-2",onUpload:e.handleAvatarUpload,onDelete:e.handleAvatarDelete},null,8,["src","name"])]),l("div",Me,[l("div",Fe,[l("label",ye,g(e.t("HELP_CENTER.PORTAL_SETTINGS.FORM.NAME.LABEL")),1),u(e.Input,{modelValue:e.state.name,"onUpdate:modelValue":o[0]||(o[0]=a=>e.state.name=a),placeholder:e.t("HELP_CENTER.PORTAL_SETTINGS.FORM.NAME.PLACEHOLDER"),"message-type":e.nameError?"error":"info",message:e.nameError,"custom-input-class":"!bg-transparent dark:!bg-transparent",onInput:o[1]||(o[1]=a=>e.v$.name.$touch()),onBlur:o[2]||(o[2]=a=>e.v$.name.$touch())},null,8,["modelValue","placeholder","message-type","message"])]),l("div",He,[l("label",we,g(e.t("HELP_CENTER.PORTAL_SETTINGS.FORM.HEADER_TEXT.LABEL")),1),u(e.Input,{modelValue:e.state.headerText,"onUpdate:modelValue":o[3]||(o[3]=a=>e.state.headerText=a),placeholder:e.t("HELP_CENTER.PORTAL_SETTINGS.FORM.HEADER_TEXT.PLACEHOLDER"),"custom-input-class":"!bg-transparent dark:!bg-transparent"},null,8,["modelValue","placeholder"])]),l("div",ke,[l("label",Be,g(e.t("HELP_CENTER.PORTAL_SETTINGS.FORM.PAGE_TITLE.LABEL")),1),u(e.Input,{modelValue:e.state.pageTitle,"onUpdate:modelValue":o[4]||(o[4]=a=>e.state.pageTitle=a),placeholder:e.t("HELP_CENTER.PORTAL_SETTINGS.FORM.PAGE_TITLE.PLACEHOLDER"),"custom-input-class":"!bg-transparent dark:!bg-transparent"},null,8,["modelValue","placeholder"])]),l("div",Ve,[l("label",je,g(e.t("HELP_CENTER.PORTAL_SETTINGS.FORM.HOME_PAGE_LINK.LABEL")),1),u(e.Input,{modelValue:e.state.homePageLink,"onUpdate:modelValue":o[5]||(o[5]=a=>e.state.homePageLink=a),placeholder:e.t("HELP_CENTER.PORTAL_SETTINGS.FORM.HOME_PAGE_LINK.PLACEHOLDER"),"message-type":e.homePageLinkError?"error":"info",message:e.homePageLinkError,"custom-input-class":"!bg-transparent dark:!bg-transparent",onInput:o[6]||(o[6]=a=>e.v$.homePageLink.$touch()),onBlur:o[7]||(o[7]=a=>e.v$.homePageLink.$touch())},null,8,["modelValue","placeholder","message-type","message"])]),l("div",We,[l("label",qe,g(e.t("HELP_CENTER.PORTAL_SETTINGS.FORM.SLUG.LABEL")),1),u(e.Input,{modelValue:e.state.slug,"onUpdate:modelValue":o[8]||(o[8]=a=>e.state.slug=a),placeholder:e.t("HELP_CENTER.PORTAL_SETTINGS.FORM.SLUG.PLACEHOLDER"),"message-type":e.slugError?"error":"info",message:e.slugError||e.buildPortalURL(e.state.slug),"custom-input-class":"!bg-transparent dark:!bg-transparent",onInput:o[9]||(o[9]=a=>e.v$.slug.$touch()),onBlur:o[10]||(o[10]=a=>e.v$.slug.$touch())},null,8,["modelValue","placeholder","message-type","message"])]),l("div",ze,[l("label",Ke,g(e.t("HELP_CENTER.PORTAL_SETTINGS.FORM.LIVE_CHAT_WIDGET.LABEL")),1),u(e.ComboBox,{modelValue:e.state.liveChatWidgetInboxId,"onUpdate:modelValue":o[11]||(o[11]=a=>e.state.liveChatWidgetInboxId=a),options:e.liveChatWidgets,placeholder:e.t("HELP_CENTER.PORTAL_SETTINGS.FORM.LIVE_CHAT_WIDGET.PLACEHOLDER"),message:e.t("HELP_CENTER.PORTAL_SETTINGS.FORM.LIVE_CHAT_WIDGET.HELP_TEXT"),class:"[&>div>button:not(.focused)]:!outline-n-weak"},null,8,["modelValue","options","placeholder","message"])]),l("div",Xe,[l("label",Je,g(e.t("HELP_CENTER.PORTAL_SETTINGS.FORM.BRAND_COLOR.LABEL")),1),l("div",Ze,[u(e.ColorPicker,{modelValue:e.state.widgetColor,"onUpdate:modelValue":o[12]||(o[12]=a=>e.state.widgetColor=a)},null,8,["modelValue"])])]),l("div",Ye,[u(e.Button,{label:e.t("HELP_CENTER.PORTAL_SETTINGS.FORM.SAVE_CHANGES"),disabled:!e.hasChanges||e.isUpdatingPortal||e.v$.$invalid,"is-loading":e.isUpdatingPortal,onClick:e.handleUpdatePortal},null,8,["label","disabled","is-loading"])])])])}const $e=M(xe,[["render",Qe],["__file","/app/app/javascript/dashboard/components-next/HelpCenter/Pages/PortalSettingsPage/PortalBaseSettings.vue"]]),et={__name:"AddCustomDomainDialog",props:{mode:{type:String,default:"add"},customDomain:{type:String,default:""}},emits:["addCustomDomain"],setup(S,{expose:o,emit:d}){const e=S,i=d,{t:s}=N(),a=P(null),_=H({customDomain:e.customDomain}),r={customDomain:{isValidDomain:V.withMessage(()=>s("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DIALOG.FORMAT_ERROR"),ue)}},E=k(r,_);Z(()=>e.customDomain,T=>{_.customDomain=T});const f=async()=>{await E.value.$validate()&&i("addCustomDomain",_.customDomain)};o({dialogRef:a});const p={props:e,emit:i,t:s,dialogRef:a,formState:_,rules:r,v$:E,handleDialogConfirm:f,ref:P,reactive:H,watch:Z,get useI18n(){return N},get useVuelidate(){return k},get helpers(){return V},get isValidDomain(){return ue},Dialog:te,Input:ee};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}};function tt(S,o,d,e,i,s){return R(),G(e.Dialog,{ref:"dialogRef",title:e.t(`HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DIALOG.${e.props.mode.toUpperCase()}_HEADER`),"confirm-button-label":e.t(`HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DIALOG.${e.props.mode.toUpperCase()}_CONFIRM_BUTTON_LABEL`),onConfirm:e.handleDialogConfirm},{default:w(()=>[u(e.Input,{modelValue:e.formState.customDomain,"onUpdate:modelValue":o[0]||(o[0]=a=>e.formState.customDomain=a),label:e.t("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DIALOG.LABEL"),placeholder:e.t("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DIALOG.PLACEHOLDER"),message:e.v$.customDomain.$error?e.v$.customDomain.$errors[0].$message:"","message-type":e.v$.customDomain.$error?"error":"info",onBlur:o[1]||(o[1]=a=>e.v$.customDomain.$touch())},null,8,["modelValue","label","placeholder","message","message-type"])]),_:1},8,["title","confirm-button-label"])}const ot=M(et,[["render",tt],["__file","/app/app/javascript/dashboard/components-next/HelpCenter/Pages/PortalSettingsPage/AddCustomDomainDialog.vue"]]),at={__name:"DNSConfigurationDialog",props:{customDomain:{type:String,default:""}},emits:["send","close"],setup(S,{expose:o,emit:d}){const e=S,i=d,{t:s}=N(),a=H({email:""}),_={email:{email:_e,required:j}},r=k(_,a),E=m(()=>{const{hostURL:A,helpCenterURL:x}=(window==null?void 0:window.chatwootConfig)||{};return Y(x)||Y(A)||""}),f=m(()=>`${e.customDomain} CNAME ${E.value}`),p=async A=>{A.stopPropagation(),await ie(f.value),O(s("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DNS_CONFIGURATION_DIALOG.COPY"))},T=P(null),h=()=>{r.value.$reset(),a.email=""},I=()=>{h(),i("close")},D=async()=>{await r.value.$validate()&&(i("send",a.email),I())};o({dialogRef:T});const L={props:e,emit:i,t:s,state:a,validationRules:_,v$:r,domain:E,subdomainCNAME:f,handleCopy:p,dialogRef:T,resetForm:h,onClose:I,handleSend:D,reactive:H,computed:m,ref:P,get useI18n(){return N},get useAlert(){return O},get copyTextToClipboard(){return ie},get getHostNameFromURL(){return Y},get email(){return _e},get required(){return j},get useVuelidate(){return k},Dialog:te,Input:ee,NextButton:W};return Object.defineProperty(L,"__isScriptSetup",{enumerable:!1,value:!0}),L}},nt={class:"flex flex-col gap-6 divide-y divide-n-strong"},lt={class:"flex flex-col gap-6"},st={class:"flex flex-col gap-2 ltr:pr-10 rtl:pl-10"},it={class:"text-base font-medium leading-6 text-n-slate-12"},rt={class:"mb-0 text-sm text-n-slate-12"},dt={class:"flex items-center gap-3 w-full"},ct={class:"min-h-10 px-3 py-2.5 inline-flex items-center w-full text-sm bg-transparent border rounded-lg text-n-slate-11 border-n-strong"},_t={class:"flex flex-col gap-6 pt-6"},ut={class:"flex flex-col gap-2 ltr:pr-10 rtl:pl-10"},mt={class:"text-base font-medium leading-6 text-n-slate-12"},gt={class:"mb-0 text-sm text-n-slate-12"};function Et(S,o,d,e,i,s){return R(),G(e.Dialog,{ref:"dialogRef","show-cancel-button":!1,"show-confirm-button":!1,onClose:e.resetForm},{default:w(()=>[u(e.NextButton,{icon:"i-lucide-x",sm:"",ghost:"",slate:"",class:"flex-shrink-0 absolute top-2 ltr:right-2 rtl:left-2",onClick:e.onClose}),l("div",nt,[l("div",lt,[l("div",st,[l("h3",it,g(e.t("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DNS_CONFIGURATION_DIALOG.HEADER")),1),l("p",rt,g(e.t("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DNS_CONFIGURATION_DIALOG.DESCRIPTION")),1)]),l("div",dt,[l("span",ct,g(e.subdomainCNAME),1),u(e.NextButton,{faded:"",slate:"",type:"button",icon:"i-lucide-copy",class:"flex-shrink-0",onClick:e.handleCopy})])]),l("div",_t,[l("div",ut,[l("h3",mt,g(e.t("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DNS_CONFIGURATION_DIALOG.SEND_INSTRUCTIONS.HEADER")),1),l("p",gt,g(e.t("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DNS_CONFIGURATION_DIALOG.SEND_INSTRUCTIONS.DESCRIPTION")),1)]),l("form",{class:"flex items-start gap-3 w-full",onSubmit:fe(e.handleSend,["prevent"])},[u(e.Input,{modelValue:e.state.email,"onUpdate:modelValue":o[0]||(o[0]=a=>e.state.email=a),placeholder:e.t("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DNS_CONFIGURATION_DIALOG.SEND_INSTRUCTIONS.PLACEHOLDER"),message:e.v$.email.$error?e.t("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DNS_CONFIGURATION_DIALOG.SEND_INSTRUCTIONS.ERROR"):"","message-type":e.v$.email.$error?"error":"info",class:"w-full",onBlur:o[1]||(o[1]=a=>e.v$.email.$touch())},null,8,["modelValue","placeholder","message","message-type"]),u(e.NextButton,{label:e.t("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DNS_CONFIGURATION_DIALOG.SEND_INSTRUCTIONS.SEND_BUTTON"),type:"submit",class:"flex-shrink-0"},null,8,["label"])],32)])])]),_:1},512)}const Tt=M(at,[["render",Et],["__file","/app/app/javascript/dashboard/components-next/HelpCenter/Pages/PortalSettingsPage/DNSConfigurationDialog.vue"]]),St={__name:"PortalConfigurationSettings",props:{activePortal:{type:Object,required:!0},isFetchingStatus:{type:Boolean,required:!0}},emits:["updatePortalConfiguration","refreshStatus","sendCnameInstructions"],setup(S,{expose:o,emit:d}){o();const e=S,i=d,s={LIVE:["active","staging_active"],PENDING:["provisioned","pending","initializing","pending_validation","pending_deployment","pending_issuance","holding_deployment","holding_validation","pending_expiration","pending_cleanup","pending_deletion","staging_deployment","backup_issued"],ERROR:["blocked","inactive","moved","expired","deleted","timed_out_initializing","timed_out_validation","timed_out_issuance","timed_out_deployment","timed_out_deletion","deactivating"]},{t:a}=N(),{isOnChatwootCloud:_}=J(),r=P(null),E=P(null),f=P(""),p=m(()=>{var t;return((t=e.activePortal)==null?void 0:t.custom_domain)||""}),T=m(()=>{var t;return((t=e.activePortal)==null?void 0:t.ssl_settings)||{}}),h=m(()=>T.value.verification_errors||""),I=m(()=>s.LIVE.includes(T.value.status)),D=m(()=>s.PENDING.includes(T.value.status)),L=m(()=>s.ERROR.includes(T.value.status)),A=m(()=>I.value?a("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.STATUS.LIVE"):D.value?a("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.STATUS.PENDING"):L.value?a("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.STATUS.ERROR"):""),x=m(()=>I.value?{text:"text-n-teal-11",bubble:"outline-n-teal-6 bg-n-teal-9"}:L.value?{text:"text-n-ruby-11",bubble:"outline-n-ruby-6 bg-n-ruby-9"}:{text:"text-n-amber-11",bubble:"outline-n-amber-6 bg-n-amber-9"}),b={props:e,emit:i,SSL_STATUS:s,t:a,isOnChatwootCloud:_,addCustomDomainDialogRef:r,dnsConfigurationDialogRef:E,updatedDomainAddress:f,customDomainAddress:p,sslSettings:T,verificationErrors:h,isLive:I,isPending:D,isError:L,statusText:A,statusColors:x,updatePortalConfiguration:t=>{var c;const n={id:(c=e.activePortal)==null?void 0:c.id,custom_domain:t};i("updatePortalConfiguration",n),r.value.dialogRef.close(),t&&(f.value=t,E.value.dialogRef.open())},closeDNSConfigurationDialog:()=>{f.value="",E.value.dialogRef.close()},onClickRefreshSSLStatus:()=>{i("refreshStatus")},onClickSend:t=>{var n;i("sendCnameInstructions",{portalSlug:(n=e.activePortal)==null?void 0:n.slug,email:t})},computed:m,ref:P,get useI18n(){return N},get useAccount(){return J},AddCustomDomainDialog:ot,DNSConfigurationDialog:Tt,Button:W};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}},Rt={class:"flex flex-col w-full gap-6"},ft={class:"flex flex-col gap-2"},pt={class:"text-base font-medium text-n-slate-12"},Ot={class:"text-sm text-n-slate-11"},Pt={class:"flex flex-col w-full gap-4"},Ct={class:"flex items-center justify-between w-full gap-2"},Nt={key:0,class:"flex flex-col gap-1"},It={class:"flex items-center w-full h-8 gap-4"},At={class:"text-sm font-medium text-n-slate-12"},Lt={class:"text-sm text-n-slate-12"},ht={key:0,class:"text-sm text-n-slate-11"},vt={class:"flex items-center"},Dt={key:0,class:"flex items-center gap-3"},xt={key:0,class:"flex items-center gap-3 flex-shrink-0"},bt={key:1,class:"w-px h-3 bg-n-weak"},Ut={key:2,class:"w-px h-3 bg-n-weak"};function Gt(S,o,d,e,i,s){const a=pe("tooltip");return R(),v("div",Rt,[l("div",ft,[l("h6",pt,g(e.t("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.HEADER")),1),l("span",Ot,g(e.t("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DESCRIPTION")),1)]),l("div",Pt,[l("div",Ct,[e.customDomainAddress?(R(),v("div",Nt,[l("div",It,[l("label",At,g(e.t("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.LABEL")),1),l("span",Lt,g(e.customDomainAddress),1)]),!e.isLive&&e.isOnChatwootCloud?(R(),v("span",ht,g(e.t("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.STATUS_DESCRIPTION")),1)):U("v-if",!0)])):U("v-if",!0),l("div",vt,[e.customDomainAddress?(R(),v("div",Dt,[e.statusText&&e.isOnChatwootCloud?Oe((R(),v("div",xt,[l("span",{class:Q(["size-1.5 rounded-full outline outline-2 block flex-shrink-0",e.statusColors.bubble])},null,2),l("span",{class:Q([e.statusColors.text,"text-sm leading-[16px] font-medium"])},g(e.statusText),3)])),[[a,e.verificationErrors]]):U("v-if",!0),e.statusText&&e.isOnChatwootCloud?(R(),v("div",bt)):U("v-if",!0),u(e.Button,{slate:"",sm:"",link:"",label:e.t("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.EDIT_BUTTON"),class:"hover:!no-underline flex-shrink-0",onClick:o[0]||(o[0]=_=>e.addCustomDomainDialogRef.dialogRef.open())},null,8,["label"]),e.isOnChatwootCloud?(R(),v("div",Ut)):U("v-if",!0),e.isOnChatwootCloud?(R(),G(e.Button,{key:3,slate:"",sm:"",link:"",icon:"i-lucide-refresh-ccw",class:Q(d.isFetchingStatus&&"animate-spin"),onClick:e.onClickRefreshSSLStatus},null,8,["class"])):U("v-if",!0)])):(R(),G(e.Button,{key:1,label:e.t("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.ADD_BUTTON"),color:"slate",onClick:o[1]||(o[1]=_=>e.addCustomDomainDialogRef.dialogRef.open())},null,8,["label"]))])])]),u(e.AddCustomDomainDialog,{ref:"addCustomDomainDialogRef",mode:e.customDomainAddress?"edit":"add","custom-domain":e.customDomainAddress,onAddCustomDomain:e.updatePortalConfiguration},null,8,["mode","custom-domain"]),u(e.DNSConfigurationDialog,{ref:"dnsConfigurationDialogRef","custom-domain":e.updatedDomainAddress||e.customDomainAddress,onClose:e.closeDNSConfigurationDialog,onSend:e.onClickSend},null,8,["custom-domain"])])}const Mt=M(St,[["render",Gt],["__file","/app/app/javascript/dashboard/components-next/HelpCenter/Pages/PortalSettingsPage/PortalConfigurationSettings.vue"]]),Ft={__name:"ConfirmDeletePortalDialog",props:{activePortalName:{type:String,required:!0}},emits:["deletePortal"],setup(S,{expose:o,emit:d}){const e=d,{t:i}=N(),s=P(null),a=()=>{e("deletePortal")};o({dialogRef:s});const _={emit:e,t:i,dialogRef:s,handleDialogConfirm:a,ref:P,get useI18n(){return N},Dialog:te};return Object.defineProperty(_,"__isScriptSetup",{enumerable:!1,value:!0}),_}};function yt(S,o,d,e,i,s){return R(),G(e.Dialog,{ref:"dialogRef",type:"alert",title:e.t("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.DELETE_PORTAL.DIALOG.HEADER",{portalName:d.activePortalName}),description:e.t("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.DELETE_PORTAL.DIALOG.DESCRIPTION"),"confirm-button-label":e.t("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.DELETE_PORTAL.DIALOG.CONFIRM_BUTTON_LABEL"),onConfirm:e.handleDialogConfirm},null,8,["title","description","confirm-button-label"])}const Ht=M(Ft,[["render",yt],["__file","/app/app/javascript/dashboard/components-next/HelpCenter/Pages/PortalSettingsPage/ConfirmDeletePortalDialog.vue"]]),wt={__name:"PortalSettings",props:{portals:{type:Array,required:!0},isFetching:{type:Boolean,required:!0}},emits:["updatePortal","updatePortalConfiguration","deletePortal","refreshStatus","sendCnameInstructions"],setup(S,{expose:o,emit:d}){o();const e=S,i=d,{t:s}=N(),a=X(),_=P(null),r=m(()=>a.params.portalSlug),E=y("portals/isSwitchingPortal"),f=y("portals/isFetchingSSLStatus"),p=m(()=>{var C;return(C=e.portals)==null?void 0:C.find(q=>q.slug===r.value)}),T=m(()=>{var C;return((C=p.value)==null?void 0:C.name)||""}),h=m(()=>e.isFetching||E.value),F={props:e,emit:i,t:s,route:a,confirmDeletePortalDialogRef:_,currentPortalSlug:r,isSwitchingPortal:E,isFetchingSSLStatus:f,activePortal:p,activePortalName:T,isLoading:h,handleUpdatePortal:C=>{i("updatePortal",C)},handleUpdatePortalConfiguration:C=>{i("updatePortalConfiguration",C)},fetchSSLStatus:()=>{i("refreshStatus")},handleSendCnameInstructions:C=>{i("sendCnameInstructions",C)},openConfirmDeletePortalDialog:()=>{_.value.dialogRef.open()},handleDeletePortal:()=>{i("deletePortal",p.value),_.value.dialogRef.close()},computed:m,ref:P,get useRoute(){return X},get useI18n(){return N},get useMapGetter(){return y},HelpCenterLayout:Pe,PortalBaseSettings:$e,PortalConfigurationSettings:Mt,ConfirmDeletePortalDialog:Ht,Spinner:Ce,Button:W};return Object.defineProperty(F,"__isScriptSetup",{enumerable:!1,value:!0}),F}},kt={key:0,class:"flex items-center justify-center py-10 pt-2 pb-8 text-n-slate-11"},Bt={key:1,class:"flex flex-col w-full gap-4 max-w-[40rem] pb-8"},Vt={class:"flex items-end justify-between w-full gap-4"},jt={class:"flex flex-col gap-2"},Wt={class:"text-base font-medium text-n-slate-12"},qt={class:"text-sm text-n-slate-11"};function zt(S,o,d,e,i,s){return R(),G(e.HelpCenterLayout,{"show-pagination-footer":!1},{content:w(()=>[e.isLoading?(R(),v("div",kt,[u(e.Spinner)])):e.activePortal?(R(),v("div",Bt,[u(e.PortalBaseSettings,{"active-portal":e.activePortal,"is-fetching":d.isFetching,onUpdatePortal:e.handleUpdatePortal},null,8,["active-portal","is-fetching"]),o[0]||(o[0]=l("div",{class:"w-full h-px bg-n-weak"},null,-1)),u(e.PortalConfigurationSettings,{"active-portal":e.activePortal,"is-fetching":d.isFetching,"is-fetching-status":e.isFetchingSSLStatus,onUpdatePortalConfiguration:e.handleUpdatePortalConfiguration,onRefreshStatus:e.fetchSSLStatus,onSendCnameInstructions:e.handleSendCnameInstructions},null,8,["active-portal","is-fetching","is-fetching-status"]),o[1]||(o[1]=l("div",{class:"w-full h-px bg-n-weak"},null,-1)),l("div",Vt,[l("div",jt,[l("h6",Wt,g(e.t("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.DELETE_PORTAL.HEADER")),1),l("span",qt,g(e.t("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.DELETE_PORTAL.DESCRIPTION")),1)]),u(e.Button,{label:e.t("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.DELETE_PORTAL.BUTTON",{portalName:e.activePortalName}),color:"ruby",class:"max-w-56 !w-fit",onClick:e.openConfirmDeletePortalDialog},null,8,["label"])])])):U("v-if",!0)]),default:w(()=>[u(e.ConfirmDeletePortalDialog,{ref:"confirmDeletePortalDialogRef","active-portal-name":e.activePortalName,onDeletePortal:e.handleDeletePortal},null,8,["active-portal-name"])]),_:1})}const Kt=M(wt,[["render",zt],["__file","/app/app/javascript/dashboard/components-next/HelpCenter/Pages/PortalSettingsPage/PortalSettings.vue"]]),me=5e3,Xt={__name:"PortalsSettingsIndexPage",setup(S,{expose:o}){o();const{t:d}=N(),e=K(),i=X(),s=ne(),{isOnChatwootCloud:a}=J(),{updateUISettings:_}=le(),r=y("portals/allPortals"),E=y("portals/isFetchingPortals"),f=y("portals/portalBySlug"),p=t=>{var n;return((n=r.value)==null?void 0:n.find(c=>c.slug!==t))??null},T=t=>{var n,c;return(c=(n=f.value(t))==null?void 0:n.meta)==null?void 0:c.default_locale},h=()=>{if(!a.value)return;const{portalSlug:t}=i.params;e.dispatch("portals/sslStatus",{portalSlug:t})},I=async(t,n)=>{const c={portalSlug:t,locale:n};await Promise.all([e.dispatch("portals/index"),e.dispatch("portals/show",c),e.dispatch("categories/index",c),e.dispatch("agents/get"),e.dispatch("inboxes/get")])},D=async t=>{const n=p(t);if(n){const{slug:c,meta:{default_locale:z}}=n;await I(c,z),s.push({name:"portals_articles_index",params:{portalSlug:c,locale:z}})}else s.push({name:"portals_new"})},L=async(t,n)=>{await I(t,n),_({last_active_portal_slug:t,last_active_locale_code:n}),await s.replace({name:"portals_settings_index",params:{portalSlug:t}})},A=async t=>{const{portalSlug:n}=i.params;try{const c=T(n);await e.dispatch("portals/update",{...t,portalSlug:n||(t==null?void 0:t.slug)}),t!=null&&t.slug&&n!==t.slug&&await L(t.slug,c),O(d("HELP_CENTER.PORTAL_SETTINGS.API.UPDATE_PORTAL.SUCCESS_MESSAGE"))}catch(c){O((c==null?void 0:c.message)||d("HELP_CENTER.PORTAL_SETTINGS.API.UPDATE_PORTAL.ERROR_MESSAGE"))}},x=async t=>{const{slug:n}=t;try{await e.dispatch("portals/delete",{portalSlug:n}),await D(n),O(d("HELP_CENTER.PORTAL.PORTAL_SETTINGS.DELETE_PORTAL.API.DELETE_SUCCESS"))}catch(c){O((c==null?void 0:c.message)||d("HELP_CENTER.PORTAL.PORTAL_SETTINGS.DELETE_PORTAL.API.DELETE_ERROR"))}},b={SSL_STATUS_FETCH_INTERVAL:me,t:d,store:e,route:i,router:s,isOnChatwootCloud:a,updateUISettings:_,portals:r,isFetching:E,getPortalBySlug:f,getNextAvailablePortal:p,getDefaultLocale:T,fetchSSLStatus:h,fetchPortalAndItsCategories:I,updateRouteAfterDeletion:D,refreshPortalRoute:L,updatePortalSettings:A,deletePortal:x,handleSendCnameInstructions:async t=>{try{await e.dispatch("portals/sendCnameInstructions",t),O(d("HELP_CENTER.PORTAL.PORTAL_SETTINGS.SEND_CNAME_INSTRUCTIONS.API.SUCCESS_MESSAGE"))}catch(n){O((n==null?void 0:n.message)||d("HELP_CENTER.PORTAL.PORTAL_SETTINGS.SEND_CNAME_INSTRUCTIONS.API.ERROR_MESSAGE"))}},handleUpdatePortal:A,handleUpdatePortalConfiguration:t=>{A(t),t!=null&&t.custom_domain&&a.value&&setTimeout(()=>{h()},me)},handleDeletePortal:x,get useI18n(){return N},get useRoute(){return X},get useRouter(){return ne},get useUISettings(){return le},get useAlert(){return O},get useMapGetter(){return y},get useStore(){return K},get useAccount(){return J},PortalSettings:Kt};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}};function Jt(S,o,d,e,i,s){return R(),G(e.PortalSettings,{portals:e.portals,"is-fetching":e.isFetching,onUpdatePortal:e.handleUpdatePortal,onUpdatePortalConfiguration:e.handleUpdatePortalConfiguration,onDeletePortal:e.handleDeletePortal,onRefreshStatus:e.fetchSSLStatus,onSendCnameInstructions:e.handleSendCnameInstructions},null,8,["portals","is-fetching","onUpdatePortal","onDeletePortal"])}const fo=M(Xt,[["render",Jt],["__file","/app/app/javascript/dashboard/routes/dashboard/helpcenter/pages/PortalsSettingsIndexPage.vue"]]);export{fo as default};
