import{_ as I,H as V,a as P,o as _,l as D,p,n as N,g as M,t as O,i as F,e as x,c as E,F as $,j as z,r as h}from"./_plugin-vue_export-helper-n_vHXFlc.js";import{u as v}from"./Validators-0vUS0OnA.js";import{u as y,b as G,c as H}from"./useBranding-C51QoB-t.js";import{L as U,c as X,o as K,u as k,l as T,q as W}from"./dashboard-DaT-cgYc.js";import{H as J}from"./HelpCenterLayout-CP5dHFgN.js";import{B as q,S as Q}from"./index-UYK3fwMr.js";import{aM as B,bU as w,aS as Y}from"./DashboardIcon-CCM-1oGA.js";import{a as b,u as R}from"./index-CQMLlWJA.js";import"./index-DN3rM4CW.js";import"./_commonjsHelpers-BosuxZz1.js";import"./utils.esm-CMazHLgs.js";import"./index-DzK6ljgP.js";import"./typing-Dhk99rRl.js";import"./vue-dompurify-html-CEAHYyWB.js";import"./useKeyboardNavigableList-B1kK16iE.js";import"./helper-BVTgYTlr.js";import"./Icon-D1o1yyYK.js";import"./module-WEXc1Yw_.js";import"./BarChart-BLu1KVZQ.js";import"./constants-lVAyZKq6.js";import"./IframeLoader-DfGHvGaO.js";import"./js.cookie-Cz0CWeBA.js";const Z={__name:"LocaleCard",props:{locale:{type:String,required:!0},isDefault:{type:Boolean,required:!0},localeCode:{type:String,required:!0},articleCount:{type:Number,required:!0},categoryCount:{type:Number,required:!0}},emits:["action"],setup(n,{expose:l,emit:t}){l();const e=n,s=t,{t:c}=y(),[o,i]=B(),a=E(()=>U.map(m=>({...m,label:c(m.label),disabled:e.isDefault}))),C={props:e,emit:s,t:c,showDropdownMenu:o,toggleDropdown:i,localeMenuItems:a,handleAction:({action:m,value:S})=>{s("action",{action:m,value:S}),i(!1)},computed:E,get useI18n(){return y},get useToggle(){return B},get LOCALE_MENU_ITEMS(){return U},CardLayout:K,Button:q,DropdownMenu:X};return Object.defineProperty(C,"__isScriptSetup",{enumerable:!1,value:!0}),C}},ee={class:"flex justify-between gap-2"},te={class:"flex items-center justify-start gap-2"},ae={class:"text-sm font-medium text-n-slate-12 line-clamp-1"},oe={key:0,class:"bg-n-alpha-2 h-6 inline-flex items-center justify-center rounded-md text-xs border-px border-transparent text-n-blue-text px-2 py-0.5"},le={class:"flex items-center justify-end gap-4"},se={class:"flex items-center gap-4"},re={class:"text-sm text-n-slate-11 whitespace-nowrap"},ne={class:"text-sm text-n-slate-11 whitespace-nowrap"},ce={class:"relative group"};function ie(n,l,t,e,s,c){const o=V("on-clickaway");return _(),P(e.CardLayout,null,{default:D(()=>[p("div",ee,[p("div",te,[p("span",ae,O(t.locale)+" ("+O(t.localeCode)+") ",1),t.isDefault?(_(),N("span",oe,O(n.$t("HELP_CENTER.LOCALES_PAGE.LOCALE_CARD.DEFAULT")),1)):M("v-if",!0)]),p("div",le,[p("div",se,[p("span",re,O(n.$t("HELP_CENTER.LOCALES_PAGE.LOCALE_CARD.ARTICLES_COUNT",t.articleCount)),1),l[1]||(l[1]=p("div",{class:"w-px h-3 bg-n-weak"},null,-1)),p("span",ne,O(n.$t("HELP_CENTER.LOCALES_PAGE.LOCALE_CARD.CATEGORIES_COUNT",t.categoryCount)),1)]),F((_(),N("div",ce,[x(e.Button,{icon:"i-lucide-ellipsis-vertical",color:"slate",size:"xs",class:"rounded-md group-hover:bg-n-alpha-2",onClick:l[0]||(l[0]=i=>e.toggleDropdown())}),e.showDropdownMenu?(_(),P(e.DropdownMenu,{key:0,"menu-items":e.localeMenuItems,class:"ltr:right-0 rtl:left-0 mt-1 xl:ltr:left-0 xl:rtl:right-0 top-full z-60 min-w-[150px]",onAction:e.handleAction},null,8,["menu-items"])):M("v-if",!0)])),[[o,()=>e.toggleDropdown(!1)]])])])]),_:1})}const ue=I(Z,[["render",ie],["__file","/app/app/javascript/dashboard/components-next/HelpCenter/LocaleCard/LocaleCard.vue"]]),de={__name:"LocaleList",props:{locales:{type:Array,required:!0},portal:{type:Object,required:!0}},setup(n,{expose:l}){l();const t=n,e=G(),{t:s}=y(),c=v(),{uiSettings:o,updateUISettings:i}=k(),a=r=>{var u,d;return((d=(u=t.portal)==null?void 0:u.meta)==null?void 0:d.default_locale)===r},g=async({newAllowedLocales:r,defaultLocale:u,messageKey:d})=>{let f="";try{await e.dispatch("portals/update",{portalSlug:t.portal.slug,config:{default_locale:u,allowed_locales:r}}),f=s(`HELP_CENTER.PORTAL.${d}.API.SUCCESS_MESSAGE`)}catch(j){f=(j==null?void 0:j.message)||s(`HELP_CENTER.PORTAL.${d}.API.ERROR_MESSAGE`)}finally{R(f)}},C=({localeCode:r})=>{const u=t.locales.map(d=>d.code);g({newAllowedLocales:u,defaultLocale:r,messageKey:"CHANGE_DEFAULT_LOCALE"}),b(w.SET_DEFAULT_LOCALE,{newLocale:r,from:c.name})},m=async r=>{const{last_active_locale_code:u}=o.value||{},d=t.portal.meta.default_locale;r===u&&await i({last_active_locale_code:d})},S=async({localeCode:r})=>{const u=t.locales.filter(f=>f.code!==r).map(f=>f.code),d=t.portal.meta.default_locale;await g({newAllowedLocales:u,defaultLocale:d,messageKey:"DELETE_LOCALE"}),await m(r),b(w.DELETE_LOCALE,{deletedLocale:r,from:c.name})},A={props:t,store:e,t:s,route:c,uiSettings:o,updateUISettings:i,isLocaleDefault:a,updatePortalLocales:g,changeDefaultLocale:C,updateLastActivePortal:m,deletePortalLocale:S,handleAction:({action:r},u)=>{r==="change-default"?C({localeCode:u}):r==="delete"&&S({localeCode:u})},LocaleCard:ue,get useStore(){return G},get useAlert(){return R},get useTrack(){return b},get useUISettings(){return k},get useI18n(){return y},get useRoute(){return v},get PORTALS_EVENTS(){return w}};return Object.defineProperty(A,"__isScriptSetup",{enumerable:!1,value:!0}),A}},pe={role:"list",class:"w-full h-full space-y-4"};function _e(n,l,t,e,s,c){return _(),N("ul",pe,[(_(!0),N($,null,z(t.locales,(o,i)=>(_(),P(e.LocaleCard,{key:i,locale:o.name,"is-default":e.isLocaleDefault(o.code),"locale-code":o.code,"article-count":o.articlesCount||0,"category-count":o.categoriesCount||0,onAction:a=>e.handleAction(a,o.code)},null,8,["locale","is-default","locale-code","article-count","category-count","onAction"]))),128))])}const Le=I(de,[["render",_e],["__file","/app/app/javascript/dashboard/components-next/HelpCenter/Pages/LocalePage/LocaleList.vue"]]),fe={__name:"AddLocaleDialog",props:{portal:{type:Object,default:()=>({})}},setup(n,{expose:l}){const t=n,{t:e}=y(),s=G(),c=v(),o=h(null),i=h(!1),a=h(""),g=E(()=>{var A;const{allowed_locales:L=[]}=((A=t.portal)==null?void 0:A.config)||{};return L.map(r=>r.code)}),C=E(()=>Object.keys(T).map(L=>({value:L,label:`${T[L]} (${L})`})).filter(L=>!g.value.includes(L.value))),m=async()=>{var A,r,u,d;if(!a.value)return;i.value=!0;const L=[...g.value,a.value];try{await s.dispatch("portals/update",{portalSlug:(A=t.portal)==null?void 0:A.slug,config:{allowed_locales:L,default_locale:(u=(r=t.portal)==null?void 0:r.meta)==null?void 0:u.default_locale}}),b(w.CREATE_LOCALE,{localeAdded:a.value,totalLocales:L.length,from:c.name}),(d=o.value)==null||d.close(),R(e("HELP_CENTER.LOCALES_PAGE.ADD_LOCALE_DIALOG.API.SUCCESS_MESSAGE"))}catch(f){R((f==null?void 0:f.message)||e("HELP_CENTER.LOCALES_PAGE.ADD_LOCALE_DIALOG.API.ERROR_MESSAGE"))}finally{i.value=!1}};l({dialogRef:o});const S={props:t,t:e,store:s,route:c,dialogRef:o,isUpdating:i,selectedLocale:a,addedLocales:g,locales:C,onCreate:m,ref:h,computed:E,get useI18n(){return y},get useStore(){return G},get useAlert(){return R},get useTrack(){return b},get useRoute(){return v},get PORTALS_EVENTS(){return w},get allLocales(){return T},Dialog:Y,ComboBox:W};return Object.defineProperty(S,"__isScriptSetup",{enumerable:!1,value:!0}),S}},Ee={class:"flex flex-col gap-6"};function me(n,l,t,e,s,c){return _(),P(e.Dialog,{ref:"dialogRef",type:"edit",title:e.t("HELP_CENTER.LOCALES_PAGE.ADD_LOCALE_DIALOG.TITLE"),description:e.t("HELP_CENTER.LOCALES_PAGE.ADD_LOCALE_DIALOG.DESCRIPTION"),onConfirm:e.onCreate},{default:D(()=>[p("div",Ee,[x(e.ComboBox,{modelValue:e.selectedLocale,"onUpdate:modelValue":l[0]||(l[0]=o=>e.selectedLocale=o),options:e.locales,placeholder:e.t("HELP_CENTER.LOCALES_PAGE.ADD_LOCALE_DIALOG.COMBOBOX.PLACEHOLDER"),class:"[&>div>button:not(.focused)]:!outline-n-slate-5 [&>div>button:not(.focused)]:dark:!outline-n-slate-5"},null,8,["modelValue","options","placeholder"])])]),_:1},8,["title","description"])}const ge=I(fe,[["render",me],["__file","/app/app/javascript/dashboard/components-next/HelpCenter/Pages/LocalePage/AddLocaleDialog.vue"]]),Ae={__name:"LocalesPage",props:{locales:{type:Array,required:!0},portal:{type:Object,default:()=>({})}},setup(n,{expose:l}){l();const t=n,e=h(null),s=H("portals/isSwitchingPortal"),c=()=>{e.value.dialogRef.open()},o=E(()=>{var a;return(a=t.locales)==null?void 0:a.length}),i={props:t,addLocaleDialogRef:e,isSwitchingPortal:s,openAddLocaleDialog:c,localeCount:o,computed:E,ref:h,get useMapGetter(){return H},HelpCenterLayout:J,Button:q,Spinner:Q,LocaleList:Le,AddLocaleDialog:ge};return Object.defineProperty(i,"__isScriptSetup",{enumerable:!1,value:!0}),i}},Ce={class:"flex items-center justify-between"},Se={class:"flex items-center gap-4"},Pe={class:"text-sm font-medium text-n-slate-12"},Oe={key:0,class:"flex items-center justify-center py-10 text-n-slate-11"};function he(n,l,t,e,s,c){return _(),P(e.HelpCenterLayout,{"show-pagination-footer":!1},{"header-actions":D(()=>[p("div",Ce,[p("div",Se,[p("span",Pe,O(n.$t("HELP_CENTER.LOCALES_PAGE.LOCALES_COUNT",e.localeCount)),1)]),x(e.Button,{label:n.$t("HELP_CENTER.LOCALES_PAGE.NEW_LOCALE_BUTTON_TEXT"),icon:"i-lucide-plus",size:"sm",onClick:e.openAddLocaleDialog},null,8,["label"])])]),content:D(()=>[e.isSwitchingPortal?(_(),N("div",Oe,[x(e.Spinner)])):(_(),P(e.LocaleList,{key:1,locales:t.locales,portal:t.portal},null,8,["locales","portal"]))]),default:D(()=>[x(e.AddLocaleDialog,{ref:"addLocaleDialogRef",portal:t.portal},null,8,["portal"])]),_:1})}const ve=I(Ae,[["render",he],["__file","/app/app/javascript/dashboard/components-next/HelpCenter/Pages/LocalePage/LocalesPage.vue"]]),ye={__name:"PortalsLocalesIndexPage",setup(n,{expose:l}){l();const t=v(),e=H("portals/portalBySlug"),s=E(()=>e.value(t.params.portalSlug)),c=E(()=>{if(!s.value)return[];const{allowed_locales:i}=s.value.config;return i.map(a=>({id:a==null?void 0:a.code,name:T[a==null?void 0:a.code],code:a==null?void 0:a.code,articlesCount:(a==null?void 0:a.articles_count)||0,categoriesCount:(a==null?void 0:a.categories_count)||0}))}),o={route:t,getPortalBySlug:e,portal:s,allowedLocales:c,computed:E,get useRoute(){return v},get useMapGetter(){return H},get allLocales(){return T},LocalesPage:ve};return Object.defineProperty(o,"__isScriptSetup",{enumerable:!1,value:!0}),o}};function De(n,l,t,e,s,c){return _(),P(e.LocalesPage,{locales:e.allowedLocales,portal:e.portal},null,8,["locales","portal"])}const Je=I(ye,[["render",De],["__file","/app/app/javascript/dashboard/routes/dashboard/helpcenter/pages/PortalsLocalesIndexPage.vue"]]);export{Je as default};
